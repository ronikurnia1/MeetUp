<ion-header>
    <ion-toolbar no-border>
        <ion-buttons left>
            <button clear color="primary" ion-button icon-only (click)="openMeetingTracker($event)">
                <ion-icon name="list-box"></ion-icon>
            </button>
        </ion-buttons>
        <ion-title (click)="filterStatus()">
            {{section}}
            <ion-icon *ngIf="section === 'Sent'" name="arrow-dropdown"></ion-icon>
            <div *ngIf="section === 'Sent'" class="sub-title">{{statusFilter}}</div>
        </ion-title>
        <ion-buttons right>
            <button clear color="primary" ion-button icon-only (click)="arrangeMeeting($event)">
                <ion-icon name="add-circle"></ion-icon>
            </button>
        </ion-buttons>
    </ion-toolbar>
    <ion-segment [(ngModel)]="section" (ionChange)="segmentChange()">
        <ion-segment-button value="My Schedule">
            My Schedule
        </ion-segment-button>
        <ion-segment-button value="Invitations">
            Invitations
        </ion-segment-button>
        <ion-segment-button value="Sent">
            Sent
        </ion-segment-button>
    </ion-segment>
    <ion-toolbar no-border>
        <ion-searchbar [value]="filterInvitation" (ionInput)="filterInvitations($event)" *ngIf="section === 'Invitations'"></ion-searchbar>
        <ion-searchbar [value]="filterHosting" (ionInput)="filterHostings($event)" *ngIf="section === 'Sent'"></ion-searchbar>
        <p class="primary-title" *ngIf="section === 'My Schedule'">{{scheduleDate}}</p>
        <p class="secondary-title" *ngIf="section === 'My Schedule'">You have {{totalMeeting}}</p>
        <button no-lines (click)="viewCalendar($event)" icon-only large ion-button clear icon-left *ngIf="section === 'My Schedule'">
            <ion-icon name="calendar"></ion-icon>
        </button>
    </ion-toolbar>
</ion-header>
<ion-content padding #pageContent [ngSwitch]="section">

    <ion-list *ngSwitchCase="'My Schedule'">
        <ion-item *ngFor="let meeting of schedules" (click)="viewMeetingDetails(meeting, 'my-schedule')" class="meeting">
            <div bp-layout="flex margin-bottom">
                <div bp-layout="fit margin-right--sm">{{meeting.time}}</div>
                <div bp-layout="fill margin-left--sm">
                    <div class="bold-text wrap-text">{{meeting.subject}}</div>
                    <div *ngIf="meeting.type==='meeting'" bp-layout="margin-top--sm" class="wrap-text">Venue: {{meeting.location}}</div>
                </div>
            </div>
        </ion-item>
    </ion-list>

    <ion-list *ngSwitchCase="'Invitations'">
        <ion-item *ngFor="let meeting of invitations" (click)="viewMeetingDetails(meeting, 'invitation')" class="meeting">
            <div bp-layout="flex">
                <ion-avatar item-left bp-layout="fit margin-right--sm">
                    <img [src]="meeting.meetingWith.avatar">
                </ion-avatar>
                <div bp-layout="fill margin-left--sm">
                    <div class="wrap-text bold-text">{{meeting.meetingWith.title}} {{meeting.meetingWith.fullName}}</div>
                    <div class="wrap-text">{{meeting.subject}}</div>
                    <div class="wrap-text">{{getDateFormated(meeting.date,'DD MMMM YYYY')}}, {{meeting.time}}</div>
                </div>
            </div>
            <div bp-layout="row center margin-top--sm margin-bottom--sm">
                <ion-buttons>

                    <button ion-button clear icon-only class="text-on-bottom" (click)="declineMeeting(meeting)" margin>
                            <ion-icon color="danger" name="close-circle"></ion-icon>
                            <span class="meeting" ion-text color="danger">Decline</span>
                        </button>
                    <button ion-button clear icon-only class="text-on-bottom" (click)="acceptMeeting(meeting)" margin>
                            <ion-icon name="checkbox-outline" color="secondary"></ion-icon>
                            <span class="meeting" ion-text color="secondary">Accept</span>
                        </button>
                    <button ion-button clear icon-only class="text-on-bottom" (click)="rescheduleMeeting(meeting)" margin>
                            <ion-icon name="time" color="primary"></ion-icon>
                            <span class="meeting" ion-text color="primary">Reschedule</span>
                        </button>

                </ion-buttons>
            </div>
        </ion-item>
    </ion-list>

    <ion-list *ngSwitchCase="'Sent'">
        <ion-item *ngFor="let meeting of hostings" (click)="viewMeetingDetails(meeting, 'hosted')" class="meeting">
            <div bp-layout="flex">
                <ion-avatar item-left bp-layout="fit margin-right--sm">
                    <img [src]="meeting.meetingWith.avatar">
                </ion-avatar>
                <div bp-layout="fill margin-left--sm">
                    <div class="pull-right status {{meeting.status}}">{{meeting.status}}</div>
                    <div class="wrap-text bold-text">{{meeting.meetingWith.title}} {{meeting.meetingWith.fullName}}</div>
                    <div class="wrap-text">{{meeting.subject}}</div>
                    <div class="wrap-text">{{getDateFormated(meeting.date,'DD MMMM YYYY')}}, {{meeting.time}}</div>
                </div>
            </div>
            <div bp-layout="row center margin-top--sm margin-bottom--sm">
                <ion-buttons>
                    <button *ngIf="meeting.status.toLowerCase() === 'pending'" ion-button clear icon-only class="text-on-bottom" (click)="rescheduleMeeting(meeting)"
                        margin>
                            <ion-icon name="time"></ion-icon>
                            <span class="meeting" ion-text color="primary">Reschedule</span>
                        </button>
                    <button *ngIf="meeting.status.toLowerCase() === 'confirmed'" ion-button clear icon-only class="text-on-bottom" (click)="cancelMeeting(meeting)"
                        margin>
                            <ion-icon color="danger" name="remove-circle"></ion-icon>
                            <span class="meeting" ion-text color="danger">Cancel Meeting</span>
                        </button>
                </ion-buttons>
            </div>
        </ion-item>
    </ion-list>

    <ion-fab bottom right *ngIf="showScanBadge">
        <button ion-fab mini (click)=scanQrCode()><ion-icon name="qr-scanner"></ion-icon></button>
    </ion-fab>
</ion-content>